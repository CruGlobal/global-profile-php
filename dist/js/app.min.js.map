{"version":3,"sources":["global-profile.module.js","api/measurements/measurements.module.js","states/admin/admin.module.js","states/app/app.module.js","states/profile/profile.module.js","states/select-ministry/select-ministry.module.js","states/admin/add/add.module.js","states/admin/edit/edit.module.js","states/admin/import/import.module.js","states/profile/edit/edit.module.js","global-profile.config.js","common/file-reader.directive.js","common/offset.filter.js","common/settings.service.js","directives/_directives.js","api/measurements/countries.service.js","api/measurements/languages.service.js","api/measurements/ministries.service.js","api/measurements/profile.service.js","api/measurements/session.service.js","components/profile-form/profile-form.directive.js","states/admin/sidebar.controller.js","states/select-ministry/select-ministry.controller.js","states/admin/add/add.controller.js","states/admin/edit/edit.controller.js","states/admin/import/import.controller.js","states/profile/edit/edit.controller.js"],"names":["angular","module","config","$stateProvider","state","parent","url","resolve","requiresLeader","$q","isLeader","gettext","deferred","defer","reject","promise","people","$log","ministry","Profile","query","ministry_id","$promise","views","@app","templateUrl","sidebar@admin","controller","$urlRouterProvider","otherwise","abstract","session","Session","getSession","systems","Ministries","ministries","whq","languages","Languages","countries","Countries","$state","$stateParams","isUndefined","min_code","transitionTo","_","findWhere","flatten","a","prop","items","forEach","item","push","hasOwnProperty","isArray","concat","assignments","where","roles","pluck","contains","title@app","$scope","template","profile","defaultProfile","content@admin","person_ID","person_id","go","get","user","response","status","props","property","this","navigation@app","$locationProvider","html5Mode","SettingsProvider","setConfig","window","globalProfile","$logProvider","debugEnabled","isDebug","$httpProvider","interceptors","growlProvider","globalPosition","globalDisableCountDown","globalTimeToLive","success","error","warning","info","directive","restrict","scope","fileReader","link","$element","$attrs","on","event","$apply","target","files","filter","input","start","parseInt","slice","provider","apiUrl","base","path","indexOf","c","environment","$get","api","measurements","ticket","factory","$http","Settings","cache","then","data","value","key","iso3","name","$resource","method","params","global_profile_only","whq_only","show_inactive","normalizeProfile","language","isString","normalizeProfileRequest","headersGetter","isObject","toJson","interceptor","resource","create","transformRequest","update","is_secure","$injector","token","isDefined","st","session_ticket","reason","request","debug","withCredentials","headers","responseError","defaultRequiredFields","require","requiredFields","transclude","showHelp","profileShowHelp","$eval","showPrivacy","profileShowPrivacy","showLeftStaff","profileShowLeftStaff","profileRequiredFields","isRequired","$watch","organizational_status","oldVal","showStaffDates","without","funding_source","showEmploymentMinistry","formatMinistryLabel","i","length","area_code","formatCountryLabel","filterText","clearFilter","$modal","growl","copy","resetForm","saveProfile","result","profileForm","$setPristine","reload","open","size","$modalInstance","ok","close","$on","toState","toParams","fromState","fromParams","$dirty","preventDefault","save","cancel","dismiss","action","saveChanges","parseCSV","file","hasHeader","Papa","parse","header","complete","results","columns","headerRow","shift","index","csv","pager","page","begin","browse","document","getElementById","click","id"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\r\n\t'use strict';\r\n\r\n\tangular.module( 'globalProfile', [\r\n\t\t// Dependencies\r\n\t\t'ui.router',\r\n\t\t'globalProfile.common.settingsService',\r\n\t\t'globalProfile.api.measurements',\r\n\t\t'angular-growl',\r\n\t\t'gettext',\r\n\r\n\t\t// States\r\n\t\t'globalProfile.states.selectMinistry',\r\n\t\t'globalProfile.states.profile.edit',\r\n\t\t'globalProfile.states.admin.add',\r\n\t\t'globalProfile.states.admin.edit',\r\n\t\t'globalProfile.states.admin.import'\r\n\t] );\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tangular.module( 'globalProfile.api.measurements', [\n\t\t// Dependencies\n\t\t'globalProfile.common.settingsService',\n\t\t'ngResource'\n\t] );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.profile',\n\t\t\t'globalProfile.api.measurements'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin', {\n\t\t\t\t\tparent:  'profile',\n\t\t\t\t\turl:     '/admin',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\t'requiresLeader': function ( $q, isLeader, gettext ) {\n\t\t\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\t\t\tif ( isLeader ) deferred.resolve(); else deferred.reject( gettext( 'Not a Leader or Inherited Leader of the ministry.' ) );\n\t\t\t\t\t\t\treturn deferred.promise;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'people':         function ( $log, ministry, Profile ) {\n\t\t\t\t\t\t\treturn Profile.query( {ministry_id: ministry.ministry_id} ).$promise;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'@app':          {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/admin.html'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'sidebar@admin': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/sidebar.html',\n\t\t\t\t\t\t\tcontroller:  'SidebarController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.app', [\n\t\t\t// Dependencies\n\t\t\t'ui.router',\n\t\t\t'globalProfile.api.measurements'\n\t\t] )\n\t\t.config( function ( $stateProvider, $urlRouterProvider ) {\n\n\t\t\t$urlRouterProvider.otherwise( '/' );\n\n\t\t\t$stateProvider.state( 'app', {\n\t\t\t\tabstract:    true,\n\t\t\t\turl:         '/',\n\t\t\t\ttemplateUrl: 'js/states/app/app.html',\n\t\t\t\tresolve:     {\n\t\t\t\t\t'session':    function ( $log, Session ) {\n\t\t\t\t\t\treturn Session.getSession();\n\t\t\t\t\t},\n\t\t\t\t\t'systems':    function ( $log, session, Ministries ) {\n\t\t\t\t\t\treturn Ministries.systems().$promise;\n\t\t\t\t\t},\n\t\t\t\t\t'ministries': function ( $log, session, Ministries ) {\n\t\t\t\t\t\treturn Ministries.whq().$promise;\n\t\t\t\t\t},\n\t\t\t\t\t'languages':  function ( $log, session, Languages ) {\n\t\t\t\t\t\treturn Languages.languages();\n\t\t\t\t\t},\n\t\t\t\t\t'countries':  function ( $log, session, Countries ) {\n\t\t\t\t\t\treturn Countries.countries();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\r\n\t'use strict';\r\n\r\n\tangular\r\n\t\t.module( 'globalProfile.states.profile', [\r\n\t\t\t'ui.router',\r\n\t\t\t'globalProfile.states.app',\r\n\t\t\t'globalProfile.api.measurements'\r\n\t\t] )\r\n\t\t.config( function ( $stateProvider ) {\r\n\t\t\t$stateProvider\r\n\t\t\t\t.state( 'profile', {\r\n\t\t\t\t\tparent:   'app',\r\n\t\t\t\t\tabstract: true,\r\n\t\t\t\t\turl:      '{min_code}',\r\n\t\t\t\t\tresolve:  {\r\n\t\t\t\t\t\t'ministry': function ( $log, $q, $state, $stateParams, session, systems ) {\r\n\t\t\t\t\t\t\tvar deferred = $q.defer();\r\n\t\t\t\t\t\t\t// Unknown min_code\r\n\t\t\t\t\t\t\tif ( angular.isUndefined( $stateParams.min_code ) || $stateParams.min_code === '' ) {\r\n\t\t\t\t\t\t\t\t$state.transitionTo( 'selectMinistry' );\r\n\t\t\t\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\tvar ministry = _.findWhere( systems, {min_code: $stateParams.min_code} );\r\n\r\n\t\t\t\t\t\t\t\t// Ministry is not a valid Global Profile system\r\n\t\t\t\t\t\t\t\tif ( angular.isUndefined( ministry ) ) {\r\n\t\t\t\t\t\t\t\t\t$state.transitionTo( 'selectMinistry' );\r\n\t\t\t\t\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tdeferred.resolve( ministry );\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn deferred.promise;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'isLeader': function ( $log, session, ministry ) {\r\n\t\t\t\t\t\t\tvar flatten = function ( a, prop ) {\r\n\t\t\t\t\t\t\t\tvar items = [];\r\n\t\t\t\t\t\t\t\tangular.forEach( a, function ( item ) {\r\n\t\t\t\t\t\t\t\t\titems.push( item );\r\n\t\t\t\t\t\t\t\t\tif ( item.hasOwnProperty( prop ) && angular.isArray( item[prop] ) ) {\r\n\t\t\t\t\t\t\t\t\t\titems = items.concat( flatten( item[prop], prop ) );\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\treturn items;\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tvar assignments = _.where( flatten( session.assignments, 'sub_ministries' ), {ministry_id: ministry.ministry_id} ),\r\n\t\t\t\t\t\t\t\troles       = _.pluck( assignments, 'team_role' );\r\n\t\t\t\t\t\t\treturn _.contains( roles, 'leader' )\r\n\t\t\t\t\t\t\t\t|| _.contains( roles, 'inherited_leader' )\r\n\t\t\t\t\t\t\t\t|| _.contains( roles, 'admin' )\r\n\t\t\t\t\t\t\t\t|| _.contains( roles, 'inherited_admin' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews:    {\r\n\t\t\t\t\t\t'title@app': {\r\n\t\t\t\t\t\t\tcontroller: function ( $scope, ministry ) {\r\n\t\t\t\t\t\t\t\t$scope.ministry = ministry;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttemplate:   '{{ministry.name}}'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t} );\r\n\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.selectMinistry', [\n\t\t\t'ui.router',\n\t\t\t'ui.bootstrap',\n\t\t\t'globalProfile.states.app'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'selectMinistry', {\n\t\t\t\t\tparent:      'app',\n\t\t\t\t\turl:         '',\n\t\t\t\t\ttemplateUrl: 'js/states/select-ministry/select-ministry.html',\n\t\t\t\t\tcontroller:  'SelectMinistryController'\n\t\t\t\t} );\n\t\t} );\n})();\n","(function () {\r\n\t'use strict';\r\n\r\n\tangular\r\n\t\t.module( 'globalProfile.states.admin.add', [\r\n\t\t\t'ui.router',\r\n\t\t\t'ui.bootstrap.modal',\r\n\t\t\t'globalProfile.states.admin',\r\n\t\t\t'globalProfile.api.measurements',\r\n\t\t\t'globalProfile.components.profileFormDirective'\r\n\t\t] )\r\n\t\t.config( function ( $stateProvider ) {\r\n\t\t\t$stateProvider\r\n\t\t\t\t.state( 'admin.add', {\r\n\t\t\t\t\turl:     '/add',\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\t'profile': function ( $log, Profile ) {\r\n\t\t\t\t\t\t\treturn Profile.defaultProfile();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews:   {\r\n\t\t\t\t\t\t'content@admin': {\r\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/add/add.html',\r\n\t\t\t\t\t\t\tcontroller:  'AddProfileController'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t} );\r\n\r\n})();\r\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin.edit', [\n\t\t\t'ui.router',\n\t\t\t'ui.bootstrap.modal',\n\t\t\t'globalProfile.states.admin',\n\t\t\t'globalProfile.components.profileFormDirective'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin.edit', {\n\t\t\t\t\turl:     '/{person_ID:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}}',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\t// person_ID must be in the list of people\n\t\t\t\t\t\t'profile':    function ( $log, $q, $stateParams, people ) {\n\t\t\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\t\t\tif ( angular.isUndefined( $stateParams.person_ID ) || $stateParams.person_ID === '' ) {\n\t\t\t\t\t\t\t\tdeferred.reject( 'Missing or Invalid person_id' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar profile = _.findWhere( people, {person_id: $stateParams.person_ID} );\n\t\t\t\t\t\t\t\tif ( angular.isUndefined( profile ) ) {\n\t\t\t\t\t\t\t\t\t$state.go( 'admin.new' );\n\t\t\t\t\t\t\t\t\tdeferred.reject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tdeferred.resolve( profile );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn deferred.promise;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'content@admin': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/edit/edit.html',\n\t\t\t\t\t\t\tcontroller:  'EditProfileController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin.import', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.admin',\n\t\t\t'globalProfile.common.fileReaderDirective',\n\t\t\t'globalProfile.common.offsetFilter'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin.import', {\n\t\t\t\t\turl:     '/import',\n\t\t\t\t\tresolve: {},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'@app': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/import/import.html',\n\t\t\t\t\t\t\tcontroller:  'ImportCSVController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\r\n\t'use strict';\r\n\r\n\tangular\r\n\t\t.module( 'globalProfile.states.profile.edit', [\r\n\t\t\t'ui.router',\r\n\t\t\t'ui.bootstrap.modal',\r\n\t\t\t'globalProfile.states.profile',\r\n\t\t\t'globalProfile.api.measurements',\r\n\t\t\t'globalProfile.components.profileFormDirective'\r\n\t\t] )\r\n\t\t.config( function ( $stateProvider ) {\r\n\t\t\t$stateProvider\r\n\t\t\t\t.state( 'edit', {\r\n\t\t\t\t\tparent:  'profile',\r\n\t\t\t\t\turl:     '',\r\n\t\t\t\t\tresolve: {\r\n\t\t\t\t\t\t'profile': function ( $log, $q, session, ministry, Profile ) {\r\n\t\t\t\t\t\t\tvar deferred = $q.defer();\r\n\t\t\t\t\t\t\tProfile\r\n\t\t\t\t\t\t\t\t.get( {\r\n\t\t\t\t\t\t\t\t\tperson_id:   session.user.person_id,\r\n\t\t\t\t\t\t\t\t\tministry_id: ministry.ministry_id\r\n\t\t\t\t\t\t\t\t}, function ( profile ) {\r\n\t\t\t\t\t\t\t\t\tdeferred.resolve( profile );\r\n\t\t\t\t\t\t\t\t}, function ( response ) {\r\n\t\t\t\t\t\t\t\t\t// Profile not found for current user\r\n\t\t\t\t\t\t\t\t\tif ( response.status === 404 ) {\r\n\t\t\t\t\t\t\t\t\t\t// Build new profile based on session.user attributes\r\n\t\t\t\t\t\t\t\t\t\tvar user = session.user,\r\n\t\t\t\t\t\t\t\t\t\t\tprops = ['key_username', 'key_guid', 'first_name', 'last_name', 'person_id'],\r\n\t\t\t\t\t\t\t\t\t\t\tprofile = Profile.defaultProfile();\r\n\t\t\t\t\t\t\t\t\t\tangular.forEach( props, function ( property ) {\r\n\t\t\t\t\t\t\t\t\t\t\t// Change key_username to email\r\n\t\t\t\t\t\t\t\t\t\t\tthis[property === 'key_username' ? 'email' : property] = user.hasOwnProperty( property ) ? user[property] : '';\r\n\t\t\t\t\t\t\t\t\t\t}, profile );\r\n\t\t\t\t\t\t\t\t\t\tdeferred.resolve( profile );\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\tdeferred.reject( response );\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\treturn deferred.promise;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tviews:   {\r\n\t\t\t\t\t\t'@app': {\r\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/profile/edit/edit.html',\r\n\t\t\t\t\t\t\tcontroller:  'EditPersonalProfileController'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'navigation@app' : {\r\n\t\t\t\t\t\t\tcontroller: function( $scope, isLeader ) {\r\n\t\t\t\t\t\t\t\t$scope.isLeader = isLeader;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttemplate: '<button type=\"button\" class=\"btn btn-sm btn-danger\" ng-if=\"isLeader\" ui-sref=\"admin\">Administrator</button>'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} )\r\n\r\n\t\t} );\r\n})();\r\n","(function ( module ) {\r\n\t'use strict';\r\n\r\n\tmodule.config( function ( $locationProvider ) {\r\n\t\t$locationProvider.html5Mode( true );\r\n\t} );\r\n\r\n\t// Initialize Application Settings\r\n\tmodule.config( function ( SettingsProvider ) {\r\n\t\tSettingsProvider.setConfig( window.globalProfile.config );\r\n\t} );\r\n\r\n\tmodule.config( function ( $logProvider, SettingsProvider ) {\r\n\t\t$logProvider.debugEnabled( SettingsProvider.isDebug() );\r\n\t} );\r\n\r\n\t// Configure HTTP interceptors\r\n\tmodule.config( function ( $httpProvider ) {\r\n\t\t$httpProvider.interceptors.push( 'Session' );\r\n\t} );\r\n\r\n\t// Configure Growl\r\n\tmodule.config( function ( growlProvider ) {\r\n\t\tgrowlProvider.globalPosition( 'top-right' );\r\n\t\tgrowlProvider.globalDisableCountDown( true );\r\n\t\tgrowlProvider.globalTimeToLive( {success: 10000, error: -1, warning: -1, info: 10000} );\r\n\t} );\r\n\r\n})( angular.module( 'globalProfile' ) );\r\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.directive( 'fileReader', [function () {\n\t\t\treturn {\n\t\t\t\trestrict: 'A',\n\t\t\t\tscope:    {\n\t\t\t\t\tfileReader: '='\n\t\t\t\t},\n\t\t\t\tlink:     function ( $scope, $element, $attrs ) {\n\t\t\t\t\t$element.on( 'change', function ( event ) {\n\t\t\t\t\t\t$scope.$apply( function () {\n\t\t\t\t\t\t\t$scope.fileReader = event.target.files[0];\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}] );\n\n})( angular.module( 'globalProfile.common.fileReaderDirective', [] ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.filter( 'offset', function () {\n\t\t\treturn function ( input, start ) {\n\t\t\t\tif ( angular.isUndefined( input ) ) return;\n\t\t\t\tstart = parseInt( start, 10 );\n\t\t\t\treturn input.slice( start );\n\t\t\t};\n\t\t} );\n\n})( angular.module( 'globalProfile.common.offsetFilter', [] ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.provider( 'Settings', function () {\n\t\tvar config = {};\n\n\t\tthis.setConfig = function ( c ) {\n\t\t\tconfig = c;\n\t\t};\n\n\t\tthis.isDebug = function () {\n\t\t\treturn config.environment === 'development';\n\t\t};\n\n\t\tfunction apiUrl( base, path ) {\n\t\t\tif ( typeof path === 'undefined' ) return base;\n\t\t\treturn ( path.indexOf( '/' ) === 0 )\n\t\t\t\t? base + path\n\t\t\t\t: base + '/' + path;\n\t\t}\n\n\t\tthis.$get = function () {\n\t\t\treturn {\n\t\t\t\tapi:    {\n\t\t\t\t\tmeasurements: function ( path ) {\n\t\t\t\t\t\treturn apiUrl( config.api.measurements, path );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tticket: config.ticket\n\t\t\t};\n\t\t}\n\t} );\n})( angular.module( 'globalProfile.common.settingsService', [] ) );\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'globalProfile.directives', [] );\n})( angular );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Countries', function ( $log, $http, Settings ) {\n\t\treturn {\n\t\t\tcountries: function () {\n\t\t\t\treturn $http.get( Settings.api.measurements( '/iso_countries' ), {\n\t\t\t\t\tcache: true\n\t\t\t\t} ).then( function ( response ) {\n\t\t\t\t\tif ( angular.isArray( response.data ) ) {\n\t\t\t\t\t\treturn response.data;\n\t\t\t\t\t}\n\t\t\t\t\tvar countries = [];\n\t\t\t\t\tangular.forEach( response.data, function ( value, key ) {\n\t\t\t\t\t\tthis.push( {\n\t\t\t\t\t\t\tiso3: key,\n\t\t\t\t\t\t\tname: value\n\t\t\t\t\t\t} );\n\t\t\t\t\t}, countries );\n\t\t\t\t\treturn countries;\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Languages', function ( $log, $http, Settings ) {\n\t\treturn {\n\t\t\tlanguages: function () {\n\t\t\t\treturn $http.get( Settings.api.measurements( '/languages' ), {\n\t\t\t\t\tcache: true\n\t\t\t\t} ).then( function ( response ) {\n\t\t\t\t\treturn response.data;\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\r\n\t'use strict';\r\n\r\n\tmodule.factory( 'Ministries', function ( $log, $resource, Settings ) {\r\n\t\treturn $resource( Settings.api.measurements( '/ministries/:ministry_id' ), {}, {\r\n\t\t\t'systems': {method: 'GET', isArray: true, params: {global_profile_only: 'true'}, cache: true},\r\n\t\t\t'whq':     {method: 'GET', isArray: true, params: {whq_only: 'true', show_inactive: 'true'}, cache: true},\r\n\t\t\t'query':   {method: 'GET', isArray: true}\r\n\t\t} );\r\n\t} );\r\n\r\n})( angular.module( 'globalProfile.api.measurements' ) );\r\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Profile', function ( $log, $resource, Settings ) {\n\t\tvar normalizeProfile = function ( profile ) {\n\t\t\t\t// Language\n\t\t\t\tif ( angular.isUndefined( profile.language ) ) {\n\t\t\t\t\tprofile.language = [];\n\t\t\t\t} else if ( angular.isString( profile.language ) ) {\n\t\t\t\t\tprofile.language = [profile.language];\n\t\t\t\t}\n\n\t\t\t\t//Assignments\n\t\t\t\tif ( angular.isUndefined( profile.assignments ) ) {\n\t\t\t\t\tprofile.assignments = [{}];\n\t\t\t\t}\n\n\t\t\t\treturn profile;\n\t\t\t},\n\t\t\tnormalizeProfileRequest = function ( profile, headersGetter ) {\n\t\t\t\tangular.forEach( profile, function ( value, key ) {\n\t\t\t\t\tif ( angular.isUndefined( value ) || value === null ) {\n\t\t\t\t\t\tdelete profile[key];\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn angular.isObject( profile ) ? angular.toJson( profile ) : profile;\n\t\t\t},\n\t\t\tapi = $resource( Settings.api.measurements( '/people/:person_id' ), {\n\t\t\t\tperson_id:   '@person_id',\n\t\t\t\tministry_id: '@ministry_id'\n\t\t\t}, {\n\t\t\t\tget:    {\n\t\t\t\t\tmethod: 'GET', interceptor: {\n\t\t\t\t\t\tresponse: function ( response ) {\n\t\t\t\t\t\t\treturn normalizeProfile( response.resource );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tquery:  {\n\t\t\t\t\tmethod: 'GET', isArray: true, interceptor: {\n\t\t\t\t\t\tresponse: function ( response ) {\n\t\t\t\t\t\t\treturn angular.forEach( response.resource, normalizeProfile );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: {method: 'POST', transformRequest: normalizeProfileRequest},\n\t\t\t\tupdate: {method: 'PUT', transformRequest: normalizeProfileRequest}\n\t\t\t} );\n\t\tapi.defaultProfile = function () {\n\t\t\treturn normalizeProfile( {\n\t\t\t\tis_secure: false\n\t\t\t} );\n\t\t};\n\t\treturn api;\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Session', function ( $injector, $q, $log, Settings ) {\n\t\tvar token,\n\t\t\tsession;\n\n\t\treturn {\n\t\t\tgetSession:    function () {\n\t\t\t\tvar deferred = $q.defer();\n\t\t\t\tif ( angular.isDefined( session ) ) {\n\t\t\t\t\tdeferred.resolve( session );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$injector.get( '$http' )\n\t\t\t\t\t\t.get( Settings.api.measurements( '/token' ), {params: {st: Settings.ticket}} )\n\t\t\t\t\t\t.then( function ( response ) {\n\t\t\t\t\t\t\ttoken = response.data.session_ticket;\n\t\t\t\t\t\t\tsession = response.data;\n\t\t\t\t\t\t\tdeferred.resolve( session );\n\t\t\t\t\t\t}, function ( reason ) {\n\t\t\t\t\t\t\tdeferred.reject( reason );\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\treturn deferred.promise;\n\t\t\t},\n\t\t\trequest:       function ( config ) {\n\t\t\t\tif ( config.url.indexOf( Settings.api.measurements() ) === 0 ) {\n\t\t\t\t\t$log.debug( 'Measurements API Request', config );\n\n\t\t\t\t\t// Enable HTTP Credentials for measurements API requests\n\t\t\t\t\tconfig.withCredentials = true;\n\n\t\t\t\t\t// Add token to request as Authorization Bearer\n\t\t\t\t\tif ( !angular.isUndefined( token ) ) {\n\t\t\t\t\t\tconfig.headers['Authorization'] = 'Bearer ' + token;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn config;\n\t\t\t},\n\t\t\tresponseError: function ( response ) {\n\t\t\t\treturn $q.reject( response );\n\t\t\t}\n\t\t}\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\r\n\t'use strict';\r\n\r\n\tmodule\r\n\t\t.directive( 'profileForm', ['$log', 'Languages', 'Countries', 'Ministries', function ( $log, Languages, Countries, Ministries ) {\r\n\t\t\tvar defaultRequiredFields = [\r\n\t\t\t\t'email',\r\n\t\t\t\t'last_name',\r\n\t\t\t\t'first_name',\r\n\t\t\t\t'gender',\r\n\t\t\t\t'birth_date',\r\n\t\t\t\t'marital_status',\r\n\t\t\t\t'country_of_residence',\r\n\t\t\t\t'language1',\r\n\t\t\t\t'organizational_status',\r\n\t\t\t\t'funding_source',\r\n\t\t\t\t'date_joined_staff',\r\n\t\t\t\t'ministry_of_employment',\r\n\t\t\t\t'assignment_ministry',\r\n\t\t\t\t'mcc',\r\n\t\t\t\t'position_role',\r\n\t\t\t\t'scope'\r\n\t\t\t];\r\n\t\t\treturn {\r\n\t\t\t\trestrict:    'E',\r\n\t\t\t\trequire:     ['^ngModel'],\r\n\t\t\t\tscope:       {\r\n\t\t\t\t\tprofile:        '=ngModel',\r\n\t\t\t\t\trequiredFields: '=?profileRequiredFields',\r\n\t\t\t\t\tministries:     '=profileMinistries',\r\n\t\t\t\t\tlanguages:      '=profileLanguages',\r\n\t\t\t\t\tcountries:      '=profileCountries'\r\n\t\t\t\t},\r\n\t\t\t\ttemplateUrl: 'js/components/profile-form/profile-form.html',\r\n\t\t\t\ttransclude:  true,\r\n\t\t\t\tlink:        function ( $scope, $element, $attrs ) {\r\n\t\t\t\t\t$scope.showHelp = angular.isUndefined( $attrs.profileShowHelp ) ? true : $scope.$eval( $attrs.profileShowHelp ) === true;\r\n\t\t\t\t\t$scope.showPrivacy = $scope.$eval( $attrs.profileShowPrivacy ) === true;\r\n\t\t\t\t\t$scope.showLeftStaff = $scope.$eval( $attrs.profileShowLeftStaff ) === true;\r\n\r\n\t\t\t\t\tif ( angular.isUndefined( $attrs.profileRequiredFields ) ) {\r\n\t\t\t\t\t\t$scope.requiredFields = defaultRequiredFields;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$scope.isRequired = function ( name ) {\r\n\t\t\t\t\t\treturn $scope.requiredFields.indexOf( name ) > -1;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t$scope.$watch( 'profile.organizational_status', function ( organizational_status, oldVal ) {\r\n\t\t\t\t\t\tif ( angular.isUndefined( organizational_status ) || organizational_status == 'Volunteer' || organizational_status == 'Other' ) {\r\n\t\t\t\t\t\t\t$scope.showStaffDates = false;\r\n\t\t\t\t\t\t\t$scope.requiredFields = _.without( $scope.requiredFields, 'date_joined_staff' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t$scope.showStaffDates = true;\r\n\t\t\t\t\t\t\tif ( _.indexOf( $scope.requiredFields, 'date_joined_staff' ) === -1 ) {\r\n\t\t\t\t\t\t\t\t$scope.requiredFields.push( 'date_joined_staff' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t$scope.$watch( 'profile.organizational_status', function ( organizational_status, oldVal ) {\r\n\t\t\t\t\t\tif ( $scope.profile.funding_source === 'Other' ) return;\r\n\t\t\t\t\t\tif ( angular.isUndefined( organizational_status ) || organizational_status == 'Volunteer' ) {\r\n\t\t\t\t\t\t\t$scope.showEmploymentMinistry = false;\r\n\t\t\t\t\t\t\t$scope.requiredFields = _.without( $scope.requiredFields, 'ministry_of_employment' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t$scope.showEmploymentMinistry = true;\r\n\t\t\t\t\t\t\tif ( _.indexOf( $scope.requiredFields, 'ministry_of_employment' ) === -1 ) {\r\n\t\t\t\t\t\t\t\t$scope.requiredFields.push( 'ministry_of_employment' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t$scope.$watch( 'profile.funding_source', function ( funding_source, oldVal ) {\r\n\t\t\t\t\t\tif ( $scope.profile.organizational_status === 'Volunteer' ) return;\r\n\t\t\t\t\t\tif ( angular.isUndefined( funding_source ) || funding_source == 'Other' ) {\r\n\t\t\t\t\t\t\t$scope.showEmploymentMinistry = false;\r\n\t\t\t\t\t\t\t$scope.requiredFields = _.without( $scope.requiredFields, 'ministry_of_employment' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t$scope.showEmploymentMinistry = true;\r\n\t\t\t\t\t\t\tif ( _.indexOf( $scope.requiredFields, 'ministry_of_employment' ) === -1 ) {\r\n\t\t\t\t\t\t\t\t$scope.requiredFields.push( 'ministry_of_employment' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t$scope.formatMinistryLabel = function ( ministry_id ) {\r\n\t\t\t\t\t\tfor ( var i = 0; i < $scope.ministries.length; i++ ) {\r\n\t\t\t\t\t\t\tif ( ministry_id === $scope.ministries[i].ministry_id ) {\r\n\t\t\t\t\t\t\t\treturn (angular.isUndefined( $scope.ministries[i].area_code ) ? 'GLBL' : $scope.ministries[i].area_code) + ' — ' + $scope.ministries[i].name;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t$scope.formatCountryLabel = function ( iso3 ) {\r\n\t\t\t\t\t\tfor ( var i = 0; i < $scope.countries.length; i++ ) {\r\n\t\t\t\t\t\t\tif ( iso3 === $scope.countries[i].iso3 ) {\r\n\t\t\t\t\t\t\t\treturn $scope.countries[i].name;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}] );\r\n\r\n})( angular.module( 'globalProfile.components.profileFormDirective', [\r\n\t'globalProfile.api.measurements'\r\n] ) );\r\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.controller( 'SidebarController', function ( $log, $scope, $state, people ) {\n\t\t\t$scope.$state = $state;\n\t\t\t$scope.people = people;\n\t\t\t$scope.filterText = '';\n\n\t\t\t$scope.clearFilter = function () {\n\t\t\t\t$scope.filterText = '';\n\t\t\t}\n\t\t} );\n\n})( angular.module( 'globalProfile.states.admin' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.controller( 'SelectMinistryController', function ( $log, $scope, $state, session, systems ) {\n\t\tfunction flatten( a, prop ) {\n\t\t\tvar items = [];\n\t\t\tangular.forEach( a, function ( item ) {\n\t\t\t\titems.push( item );\n\t\t\t\tif ( item.hasOwnProperty( prop ) && angular.isArray( item[prop] ) ) {\n\t\t\t\t\titems = items.concat( flatten( item[prop], prop ) );\n\t\t\t\t}\n\t\t\t} );\n\t\t\treturn items;\n\t\t}\n\n\t\tvar assignments = flatten( session.assignments, 'sub_ministries' );\n\n\t\t$scope.$state = $state;\n\t\t$scope.ministries = systems;\n\n\t\t$scope.isLeader = function ( ministry_id ) {\n\t\t\tvar roles = _.pluck( _.where( assignments, {ministry_id: ministry_id} ), 'team_role' );\n\t\t\treturn _.contains( roles, 'leader' ) || _.contains( roles, 'inherited_leader' );\n\t\t};\n\t} );\n\n})( angular.module( 'globalProfile.states.selectMinistry' ) );\n","(function ( module ) {\r\n\t'use strict';\r\n\r\n\tmodule\r\n\t\t.controller( 'AddProfileController', function ( $log, $scope, $modal, $state, profile, ministry, Profile, ministries, countries, languages, growl, gettext ) {\r\n\t\t\t$scope.$state = $state;\r\n\t\t\t$scope.requiredFields = [\r\n\t\t\t\t'email',\r\n\t\t\t\t'last_name',\r\n\t\t\t\t'first_name',\r\n\t\t\t\t'gender',\r\n\t\t\t\t'birth_date',\r\n\t\t\t\t'marital_status',\r\n\t\t\t\t'country_of_residence',\r\n\t\t\t\t'language1',\r\n\t\t\t\t'organizational_status',\r\n\t\t\t\t'funding_source',\r\n\t\t\t\t'date_joined_staff',\r\n\t\t\t\t'ministry_of_employment',\r\n\t\t\t\t'assignment_ministry',\r\n\t\t\t\t'mcc',\r\n\t\t\t\t'position_role',\r\n\t\t\t\t'scope'\r\n\t\t\t];\r\n\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t$scope.ministries = ministries;\r\n\t\t\t$scope.countries = countries;\r\n\t\t\t$scope.languages = languages;\r\n\r\n\t\t\t$scope.resetForm = function () {\r\n\t\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t};\r\n\r\n\t\t\t$scope.saveProfile = function () {\r\n\t\t\t\tProfile.create( {ministry_id: ministry.ministry_id}, $scope.profile, function ( result ) {\r\n\t\t\t\t\t$scope.profileForm.$setPristine();\r\n\r\n\t\t\t\t\tgrowl.success( gettext( 'Profile successfully saved.' ) );\r\n\r\n\t\t\t\t\t$state.go( 'admin.edit', {person_ID: result.person_id}, {reload: true} );\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\t$modal.open( {\r\n\t\t\t\t\t\ttemplateUrl: 'js/states/admin/error.modal.html',\r\n\t\t\t\t\t\tsize:        'sm',\r\n\t\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\r\n\t\t\t\t\t\t\t$scope.ok = function () {\r\n\t\t\t\t\t\t\t\t$modalInstance.close();\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\t\t\t\t} );\r\n\t\t\t};\r\n\r\n\t\t\t$scope.$on( '$stateChangeStart', function ( event, toState, toParams, fromState, fromParams ) {\r\n\t\t\t\tif ( $scope.profileForm.$dirty ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t$modal.open( {\r\n\t\t\t\t\t\ttemplateUrl: 'js/states/admin/unsaved.modal.html',\r\n\t\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\r\n\t\t\t\t\t\t\t$scope.save = function () {\r\n\t\t\t\t\t\t\t\t$modalInstance.close();\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t$scope.cancel = function () {\r\n\t\t\t\t\t\t\t\t$modalInstance.dismiss( 'discard' );\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} ).result.then( function () {\r\n\t\t\t\t\t\t}, function ( action ) {\r\n\t\t\t\t\t\t\tif ( action === 'discard' ) {\r\n\t\t\t\t\t\t\t\t$scope.profileForm.$setPristine();\r\n\t\t\t\t\t\t\t\t$state.transitionTo( toState, toParams );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t} );\r\n\r\n})( angular.module( 'globalProfile.states.admin.add' ) );\r\n","(function ( module ) {\r\n\t'use strict';\r\n\r\n\tmodule\r\n\t\t.controller( 'EditProfileController', function ( $log, $scope, $state, profile, ministry, Profile, $modal, ministries, countries, languages, growl, gettext ) {\r\n\t\t\t$scope.$state = $state;\r\n\t\t\t$scope.requiredFields = [\r\n\t\t\t\t'email',\r\n\t\t\t\t'last_name',\r\n\t\t\t\t'first_name',\r\n\t\t\t\t'gender',\r\n\t\t\t\t'birth_date',\r\n\t\t\t\t'marital_status',\r\n\t\t\t\t'country_of_residence',\r\n\t\t\t\t'language1',\r\n\t\t\t\t'organizational_status',\r\n\t\t\t\t'funding_source',\r\n\t\t\t\t'date_joined_staff',\r\n\t\t\t\t'ministry_of_employment',\r\n\t\t\t\t'assignment_ministry',\r\n\t\t\t\t'mcc',\r\n\t\t\t\t'position_role',\r\n\t\t\t\t'scope'\r\n\t\t\t];\r\n\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t$scope.ministries = ministries;\r\n\t\t\t$scope.countries = countries;\r\n\t\t\t$scope.languages = languages;\r\n\r\n\t\t\t$scope.resetForm = function () {\r\n\t\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t\t$scope.profileForm.$setPristine();\r\n\t\t\t};\r\n\r\n\t\t\t$scope.saveChanges = function () {\r\n\t\t\t\tProfile.update( {ministry_id: ministry.ministry_id}, $scope.profile, function ( result ) {\r\n\t\t\t\t\t// Success\r\n\t\t\t\t\tgrowl.success( gettext( 'Profile successfully saved.' ) );\r\n\t\t\t\t\tprofile = result;\r\n\t\t\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t\t\t$scope.profileForm.$setPristine();\r\n\t\t\t\t}, function () {\r\n\t\t\t\t\t// Error\r\n\t\t\t\t\t$modal.open( {\r\n\t\t\t\t\t\ttemplateUrl: 'js/states/admin/error.modal.html',\r\n\t\t\t\t\t\tsize:        'sm',\r\n\t\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\r\n\t\t\t\t\t\t\t$scope.ok = function () {\r\n\t\t\t\t\t\t\t\t$modalInstance.close();\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} );\r\n\t\t\t\t} );\r\n\t\t\t};\r\n\r\n\t\t\t$scope.$on( '$stateChangeStart', function ( event, toState, toParams, fromState, fromParams ) {\r\n\t\t\t\tif ( $scope.profileForm.$dirty ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t$modal.open( {\r\n\t\t\t\t\t\ttemplateUrl: 'js/states/admin/unsaved.modal.html',\r\n\t\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\r\n\t\t\t\t\t\t\t$scope.save = function () {\r\n\t\t\t\t\t\t\t\t$modalInstance.close();\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t$scope.cancel = function () {\r\n\t\t\t\t\t\t\t\t$modalInstance.dismiss( 'discard' );\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} ).result.then( function () {\r\n\t\t\t\t\t\t}, function ( action ) {\r\n\t\t\t\t\t\t\tif ( action === 'discard' ) {\r\n\t\t\t\t\t\t\t\t$scope.profileForm.$setPristine();\r\n\t\t\t\t\t\t\t\t$state.transitionTo( toState, toParams );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t} );\r\n\r\n})( angular.module( 'globalProfile.states.admin.edit' ) );\r\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.controller( 'ImportCSVController', function ( $log, $scope, $state, ministry, Profile ) {\n\t\t\t$scope.$state = $state;\n\t\t\t$scope.hasHeader = true;\n\t\t\t$scope.columns = [];\n\t\t\t$scope.pager = {\n\t\t\t\tpage:  1,\n\t\t\t\tbegin: 0\n\t\t\t};\n\n\t\t\t$scope.browse = function () {\n\t\t\t\tdocument.getElementById( 'fileBrowser' ).click();\n\t\t\t};\n\n\t\t\t$scope.$watch( 'file', function ( file ) {\n\t\t\t\tif ( angular.isUndefined( file ) ) return;\n\t\t\t\tparseCSV();\n\t\t\t} );\n\n\t\t\t$scope.$watch( 'hasHeader', function ( hasHeader ) {\n\t\t\t\tparseCSV();\n\t\t\t} );\n\n\t\t\t$scope.$watch( 'pager.page', function ( page ) {\n\t\t\t\tif ( angular.isUndefined( $scope.csv ) ) return;\n\t\t\t\t$scope.pager.begin = (page - 1) * 10;\n\t\t\t} );\n\n\t\t\tfunction parseCSV() {\n\t\t\t\tif ( angular.isUndefined( $scope.file ) ) return;\n\t\t\t\tif ( angular.isUndefined( $scope.hasHeader ) ) return;\n\n\t\t\t\tPapa.parse( $scope.file, {\n\t\t\t\t\theader:   false, // We remove first row manually if hasHeader is true\n\t\t\t\t\tcomplete: function ( results, file ) {\n\t\t\t\t\t\tvar columns = [];\n\t\t\t\t\t\t$scope.$apply( function () {\n\t\t\t\t\t\t\tif ( $scope.hasHeader ) {\n\t\t\t\t\t\t\t\t$scope.headerRow = results.data.shift();\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < $scope.headerRow.length; i++ )\n\t\t\t\t\t\t\t\t\tcolumns.push( {index: i} );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdelete $scope.headerRow;\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < results.data[0].length; i++ )\n\t\t\t\t\t\t\t\t\tcolumns.push( {index: i} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$scope.columns = columns;\n\t\t\t\t\t\t\t$scope.csv = results;\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t}\n\t\t} );\n\n})( angular.module( 'globalProfile.states.admin.import' ) );\n","(function ( module ) {\r\n\t'use strict';\r\n\r\n\tmodule.controller( 'EditPersonalProfileController', function ( $log, $scope, $modal, session, ministry, profile, Profile, ministries, countries, languages, growl, gettext ) {\r\n\t\t$scope.profile = angular.copy( profile );\r\n\t\t$scope.ministries = ministries;\r\n\t\t$scope.countries = countries;\r\n\t\t$scope.languages = languages;\r\n\r\n\t\t$scope.resetForm = function () {\r\n\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t$scope.profileForm.$setPristine();\r\n\t\t};\r\n\r\n\t\t$scope.saveChanges = function () {\r\n\t\t\tvar method = angular.isUndefined( profile.id ) ? 'create' : 'update';\r\n\t\t\tProfile[method]( {ministry_id: ministry.ministry_id}, $scope.profile, function ( response ) {\r\n\t\t\t\t// Success\r\n\t\t\t\tgrowl.success( gettext( 'Profile successfully saved.' ) );\r\n\t\t\t\tprofile = response;\r\n\t\t\t\t$scope.profile = angular.copy( profile );\r\n\t\t\t\t$scope.profileForm.$setPristine();\r\n\t\t\t}, function () {\r\n\t\t\t\t// Error\r\n\t\t\t\t$modal.open( {\r\n\t\t\t\t\ttemplateUrl: 'js/states/admin/error.modal.html',\r\n\t\t\t\t\tsize:        'sm',\r\n\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\r\n\t\t\t\t\t\t$scope.ok = function () {\r\n\t\t\t\t\t\t\t$modalInstance.close();\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t} );\r\n\t\t};\r\n\t} );\r\n})( angular.module( 'globalProfile.states.profile.edit' ) );\r\n"],"sourceRoot":"/source/"}