{"version":3,"sources":["global-profile.module.js","api/measurements/measurements.module.js","states/admin/admin.module.js","states/app/app.module.js","states/profile/profile.module.js","states/select-ministry/select-ministry.module.js","states/admin/add/add.module.js","states/admin/edit/edit.module.js","states/admin/import/import.module.js","states/profile/edit/edit.module.js","global-profile.config.js","common/file-reader.directive.js","common/offset.filter.js","common/settings.service.js","directives/_directives.js","api/measurements/countries.service.js","api/measurements/languages.service.js","api/measurements/ministries.service.js","api/measurements/profile.service.js","api/measurements/session.service.js","components/profile-form/profile-form.directive.js","states/admin/sidebar.controller.js","states/select-ministry/select-ministry.controller.js","states/admin/add/add.controller.js","states/admin/edit/edit.controller.js","states/admin/import/import.controller.js","states/profile/edit/edit.controller.js"],"names":["angular","module","config","$stateProvider","state","parent","url","resolve","requiresLeader","$q","isLeader","deferred","defer","reject","promise","people","$log","ministry","Profile","query","ministry_id","$promise","views","@app","templateUrl","sidebar@admin","controller","$urlRouterProvider","otherwise","abstract","session","Session","getSession","systems","Ministries","$state","$stateParams","isUndefined","min_code","transitionTo","_","findWhere","flatten","a","prop","items","forEach","item","push","hasOwnProperty","isArray","concat","assignments","where","roles","pluck","contains","title@app","$scope","template","profile","defaultProfile","content@admin","person_ID","person_id","go","get","user","response","status","props","property","this","navigation@app","$locationProvider","html5Mode","SettingsProvider","setConfig","window","globalProfile","$logProvider","debugEnabled","isDebug","$httpProvider","interceptors","directive","restrict","scope","fileReader","link","$element","$attrs","on","event","$apply","target","files","filter","input","start","parseInt","slice","provider","apiUrl","base","path","indexOf","c","environment","$get","api","measurements","ticket","factory","$http","Settings","countries","cache","then","data","value","key","iso3","name","languages","$resource","method","params","global_profile_only","normalizeProfile","language","isString","interceptor","resource","create","update","is_secure","$injector","token","isDefined","st","session_ticket","reason","request","debug","withCredentials","headers","responseError","Languages","Countries","defaultRequiredFields","require","requiredFields","transclude","whq_only","ministries","showHelp","profileShowHelp","$eval","showPrivacy","profileShowPrivacy","showLeftStaff","profileShowLeftStaff","profileRequiredFields","isRequired","$watch","organizational_status","oldVal","showStaffDates","without","funding_source","showEmploymentMinistry","filterText","clearFilter","copy","resetForm","saveProfile","result","reload","error","$on","toState","toParams","fromState","fromParams","profileForm","$dirty","preventDefault","$modal","open","$modalInstance","save","close","cancel","dismiss","action","$setPristine","saveChanges","parseCSV","file","hasHeader","Papa","parse","header","complete","results","columns","headerRow","shift","i","length","index","csv","pager","page","begin","browse","document","getElementById","click","id"],"mappings":"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","file":"app.min.js","sourcesContent":["(function () {\n\t'use strict';\n\n\tangular.module( 'globalProfile', [\n\t\t// Dependencies\n\t\t'ui.router',\n\t\t'globalProfile.common.settingsService',\n\t\t'globalProfile.api.measurements',\n\n\t\t// States\n\t\t'globalProfile.states.selectMinistry',\n\t\t'globalProfile.states.profile.edit',\n\t\t'globalProfile.states.admin.add',\n\t\t'globalProfile.states.admin.edit',\n\t\t'globalProfile.states.admin.import'\n\t] );\n})();\n","(function () {\n\t'use strict';\n\n\tangular.module( 'globalProfile.api.measurements', [\n\t\t// Dependencies\n\t\t'globalProfile.common.settingsService',\n\t\t'ngResource'\n\t] );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.profile',\n\t\t\t'globalProfile.api.measurements'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin', {\n\t\t\t\t\tparent:  'profile',\n\t\t\t\t\turl:     '/admin',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\t'requiresLeader': function ( $q, isLeader ) {\n\t\t\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\t\t\tif ( isLeader ) deferred.resolve(); else deferred.reject( 'Not a Leader or Inherited Leader of the ministry.' );\n\t\t\t\t\t\t\treturn deferred.promise;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'people':         function ( $log, ministry, Profile ) {\n\t\t\t\t\t\t\treturn Profile.query( {ministry_id: ministry.ministry_id} ).$promise;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'@app':          {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/admin.html'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'sidebar@admin': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/sidebar.html',\n\t\t\t\t\t\t\tcontroller:  'SidebarController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.app', [\n\t\t\t// Dependencies\n\t\t\t'ui.router',\n\t\t\t'globalProfile.api.measurements'\n\t\t] )\n\t\t.config( function ( $stateProvider, $urlRouterProvider ) {\n\n\t\t\t$urlRouterProvider.otherwise( '/' );\n\n\t\t\t$stateProvider.state( 'app', {\n\t\t\t\tabstract:    true,\n\t\t\t\turl:         '/',\n\t\t\t\ttemplateUrl: 'js/states/app/app.html',\n\t\t\t\tresolve:     {\n\t\t\t\t\t'session': function ( $log, Session ) {\n\t\t\t\t\t\treturn Session.getSession();\n\t\t\t\t\t},\n\t\t\t\t\t'systems': function ( $log, session, Ministries ) {\n\t\t\t\t\t\treturn Ministries.systems().$promise;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.profile', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.app',\n\t\t\t'globalProfile.api.measurements'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'profile', {\n\t\t\t\t\tparent:   'app',\n\t\t\t\t\tabstract: true,\n\t\t\t\t\turl:      '{min_code}',\n\t\t\t\t\tresolve:  {\n\t\t\t\t\t\t'ministry':  function ( $log, $q, $state, $stateParams, session, systems ) {\n\t\t\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\t\t\t// Unknown min_code\n\t\t\t\t\t\t\tif ( angular.isUndefined( $stateParams.min_code ) || $stateParams.min_code === '' ) {\n\t\t\t\t\t\t\t\t$state.transitionTo( 'selectMinistry' );\n\t\t\t\t\t\t\t\tdeferred.reject();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar ministry = _.findWhere( systems, {min_code: $stateParams.min_code} );\n\n\t\t\t\t\t\t\t\t// Ministry is not a valid Global Profile system\n\t\t\t\t\t\t\t\tif ( angular.isUndefined( ministry ) ) {\n\t\t\t\t\t\t\t\t\t$state.transitionTo( 'selectMinistry' );\n\t\t\t\t\t\t\t\t\tdeferred.reject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tdeferred.resolve( ministry );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn deferred.promise;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'isLeader':  function ( $log, session, ministry ) {\n\t\t\t\t\t\t\tvar flatten = function ( a, prop ) {\n\t\t\t\t\t\t\t\tvar items = [];\n\t\t\t\t\t\t\t\tangular.forEach( a, function ( item ) {\n\t\t\t\t\t\t\t\t\titems.push( item );\n\t\t\t\t\t\t\t\t\tif ( item.hasOwnProperty( prop ) && angular.isArray( item[prop] ) ) {\n\t\t\t\t\t\t\t\t\t\titems = items.concat( flatten( item[prop], prop ) );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t\treturn items;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tvar assignments = _.where( flatten( session.assignments, 'sub_ministries' ), {ministry_id: ministry.ministry_id} ),\n\t\t\t\t\t\t\t\troles = _.pluck( assignments, 'team_role' );\n\t\t\t\t\t\t\treturn _.contains( roles, 'leader' ) || _.contains( roles, 'inherited_leader' );\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:    {\n\t\t\t\t\t\t'title@app': {\n\t\t\t\t\t\t\tcontroller: function ( $scope, ministry ) {\n\t\t\t\t\t\t\t\t$scope.ministry = ministry;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate:   '{{ministry.name}}'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.selectMinistry', [\n\t\t\t'ui.router',\n\t\t\t'ui.bootstrap',\n\t\t\t'globalProfile.states.app'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'selectMinistry', {\n\t\t\t\t\tparent:      'app',\n\t\t\t\t\turl:         '',\n\t\t\t\t\ttemplateUrl: 'js/states/select-ministry/select-ministry.html',\n\t\t\t\t\tcontroller:  'SelectMinistryController'\n\t\t\t\t} );\n\t\t} );\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin.add', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.admin',\n\t\t\t'globalProfile.api.measurements',\n\t\t\t'globalProfile.components.profileFormDirective'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin.add', {\n\t\t\t\t\turl:     '/add',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\t'profile': function ( $log, Profile ) {\n\t\t\t\t\t\t\treturn Profile.defaultProfile();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'content@admin': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/add/add.html',\n\t\t\t\t\t\t\tcontroller:  'AddProfileController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin.edit', [\n\t\t\t'ui.router',\n\t\t\t'ui.bootstrap.modal',\n\t\t\t'globalProfile.states.admin',\n\t\t\t'globalProfile.components.profileFormDirective'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin.edit', {\n\t\t\t\t\turl:     '/{person_ID:[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}}',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\t// person_ID must be in the list of people\n\t\t\t\t\t\t'profile': function ( $log, $q, $stateParams, people ) {\n\t\t\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\t\t\tif ( angular.isUndefined( $stateParams.person_ID ) || $stateParams.person_ID === '' ) {\n\t\t\t\t\t\t\t\tdeferred.reject( 'Missing or Invalid person_id' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tvar profile = _.findWhere( people, {person_id: $stateParams.person_ID} );\n\t\t\t\t\t\t\t\tif ( angular.isUndefined( profile ) ) {\n\t\t\t\t\t\t\t\t\t$state.go( 'admin.new' );\n\t\t\t\t\t\t\t\t\tdeferred.reject();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tdeferred.resolve( profile );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn deferred.promise;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'content@admin': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/edit/edit.html',\n\t\t\t\t\t\t\tcontroller:  'EditProfileController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.admin.import', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.admin',\n\t\t\t'globalProfile.common.fileReaderDirective',\n\t\t\t'globalProfile.common.offsetFilter'\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'admin.import', {\n\t\t\t\t\turl:     '/import',\n\t\t\t\t\tresolve: {},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'@app': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/admin/import/import.html',\n\t\t\t\t\t\t\tcontroller:  'ImportCSVController'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t} );\n\n})();\n","(function () {\n\t'use strict';\n\n\tangular\n\t\t.module( 'globalProfile.states.profile.edit', [\n\t\t\t'ui.router',\n\t\t\t'globalProfile.states.profile',\n\t\t\t'globalProfile.api.measurements',\n\t\t\t'globalProfile.components.profileFormDirective',\n\t\t] )\n\t\t.config( function ( $stateProvider ) {\n\t\t\t$stateProvider\n\t\t\t\t.state( 'edit', {\n\t\t\t\t\tparent:  'profile',\n\t\t\t\t\turl:     '',\n\t\t\t\t\tresolve: {\n\t\t\t\t\t\t'profile': function ( $log, $q, session, ministry, Profile ) {\n\t\t\t\t\t\t\tvar deferred = $q.defer();\n\t\t\t\t\t\t\tProfile\n\t\t\t\t\t\t\t\t.get( {\n\t\t\t\t\t\t\t\t\tperson_id:   session.user.person_id,\n\t\t\t\t\t\t\t\t\tministry_id: ministry.ministry_id\n\t\t\t\t\t\t\t\t}, function ( profile ) {\n\t\t\t\t\t\t\t\t\tdeferred.resolve( profile );\n\t\t\t\t\t\t\t\t}, function ( response ) {\n\t\t\t\t\t\t\t\t\t// Profile not found for current user\n\t\t\t\t\t\t\t\t\tif ( response.status === 404 ) {\n\t\t\t\t\t\t\t\t\t\t// Build new profile based on session.user attributes\n\t\t\t\t\t\t\t\t\t\tvar user = session.user,\n\t\t\t\t\t\t\t\t\t\t\tprops = ['cas_username', 'key_guid', 'first_name', 'last_name', 'person_id'],\n\t\t\t\t\t\t\t\t\t\t\tprofile = Profile.defaultProfile();\n\t\t\t\t\t\t\t\t\t\tangular.forEach( props, function ( property ) {\n\t\t\t\t\t\t\t\t\t\t\t// Change cas_username to email\n\t\t\t\t\t\t\t\t\t\t\tthis[property === 'cas_username' ? 'email' : 'property'] = user.hasOwnProperty( property ) ? user[property] : '';\n\t\t\t\t\t\t\t\t\t\t}, profile );\n\t\t\t\t\t\t\t\t\t\tdeferred.resolve( profile );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t\tdeferred.reject( response );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\treturn deferred.promise;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tviews:   {\n\t\t\t\t\t\t'@app': {\n\t\t\t\t\t\t\ttemplateUrl: 'js/states/profile/edit/edit.html',\n\t\t\t\t\t\t\tcontroller:  'EditPersonalProfileController'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'navigation@app' : {\n\t\t\t\t\t\t\tcontroller: function( $scope, isLeader ) {\n\t\t\t\t\t\t\t\t$scope.isLeader = isLeader;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate: '<button type=\"button\" class=\"btn btn-sm btn-danger\" ng-if=\"isLeader\" ui-sref=\"admin\">Administrator</button>'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} )\n\n\t\t} );\n})();\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.config( function ( $locationProvider ) {\n\t\t$locationProvider.html5Mode( true );\n\t} );\n\n\t// Initialize Application Settings\n\tmodule.config( function ( SettingsProvider ) {\n\t\tSettingsProvider.setConfig( window.globalProfile.config );\n\t} );\n\n\tmodule.config( function ( $logProvider, SettingsProvider ) {\n\t\t$logProvider.debugEnabled( SettingsProvider.isDebug() );\n\t} );\n\n\t// Configure HTTP interceptors\n\tmodule.config( function ( $httpProvider ) {\n\t\t$httpProvider.interceptors.push( 'Session' );\n\t} );\n\n})( angular.module( 'globalProfile' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.directive( 'fileReader', [function () {\n\t\t\treturn {\n\t\t\t\trestrict: 'A',\n\t\t\t\tscope:    {\n\t\t\t\t\tfileReader: '='\n\t\t\t\t},\n\t\t\t\tlink:     function ( $scope, $element, $attrs ) {\n\t\t\t\t\t$element.on( 'change', function ( event ) {\n\t\t\t\t\t\t$scope.$apply( function () {\n\t\t\t\t\t\t\t$scope.fileReader = event.target.files[0];\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}] );\n\n})( angular.module( 'globalProfile.common.fileReaderDirective', [] ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.filter( 'offset', function () {\n\t\t\treturn function ( input, start ) {\n\t\t\t\tif ( angular.isUndefined( input ) ) return;\n\t\t\t\tstart = parseInt( start, 10 );\n\t\t\t\treturn input.slice( start );\n\t\t\t};\n\t\t} );\n\n})( angular.module( 'globalProfile.common.offsetFilter', [] ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.provider( 'Settings', function () {\n\t\tvar config = {};\n\n\t\tthis.setConfig = function ( c ) {\n\t\t\tconfig = c;\n\t\t};\n\n\t\tthis.isDebug = function () {\n\t\t\treturn config.environment === 'development';\n\t\t};\n\n\t\tfunction apiUrl( base, path ) {\n\t\t\tif ( typeof path === 'undefined' ) return base;\n\t\t\treturn ( path.indexOf( '/' ) === 0 )\n\t\t\t\t? base + path\n\t\t\t\t: base + '/' + path;\n\t\t}\n\n\t\tthis.$get = function () {\n\t\t\treturn {\n\t\t\t\tapi:    {\n\t\t\t\t\tmeasurements: function ( path ) {\n\t\t\t\t\t\treturn apiUrl( config.api.measurements, path );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tticket: config.ticket\n\t\t\t};\n\t\t}\n\t} );\n})( angular.module( 'globalProfile.common.settingsService', [] ) );\n","(function ( angular ) {\n\t'use strict';\n\tangular.module( 'globalProfile.directives', [] );\n})( angular );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Countries', function ( $log, $http, Settings ) {\n\t\treturn {\n\t\t\tcountries: function () {\n\t\t\t\treturn $http.get( Settings.api.measurements( '/iso_countries' ), {\n\t\t\t\t\tcache: true\n\t\t\t\t} ).then( function ( response ) {\n\t\t\t\t\tif ( angular.isArray( response.data ) ) {\n\t\t\t\t\t\treturn response.data;\n\t\t\t\t\t}\n\t\t\t\t\tvar countries = [];\n\t\t\t\t\tangular.forEach( response.data, function ( value, key ) {\n\t\t\t\t\t\tthis.push( {\n\t\t\t\t\t\t\tiso3: key,\n\t\t\t\t\t\t\tname: value\n\t\t\t\t\t\t} );\n\t\t\t\t\t}, countries );\n\t\t\t\t\treturn countries;\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Languages', function ( $log, $http, Settings ) {\n\t\treturn {\n\t\t\tlanguages: function () {\n\t\t\t\treturn $http.get( Settings.api.measurements( '/languages' ), {\n\t\t\t\t\tcache: true\n\t\t\t\t} ).then( function ( response ) {\n\t\t\t\t\treturn response.data;\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Ministries', function ( $log, $resource, Settings ) {\n\t\treturn $resource( Settings.api.measurements( '/ministries/:ministry_id' ), {}, {\n\t\t\t'systems': {method: 'GET', isArray: true, params: {global_profile_only: 'true'}, cache: true},\n\t\t\t'query':   {method: 'GET', isArray: true}\n\t\t} );\n\t} );\n\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Profile', function ( $log, $resource, Settings ) {\n\t\tvar normalizeProfile = function ( profile ) {\n\t\t\t\t// Language\n\t\t\t\tif ( angular.isUndefined( profile.language ) ) {\n\t\t\t\t\tprofile.language = [];\n\t\t\t\t} else if ( angular.isString( profile.language ) ) {\n\t\t\t\t\tprofile.language = [profile.language];\n\t\t\t\t}\n\n\t\t\t\t//Assignments\n\t\t\t\tif ( angular.isUndefined( profile.assignments ) ) {\n\t\t\t\t\tprofile.assignments = [{}];\n\t\t\t\t}\n\n\t\t\t\treturn profile;\n\t\t\t},\n\t\t\tapi = $resource( Settings.api.measurements( '/people/:person_id' ), {\n\t\t\t\tperson_id:   '@person_id',\n\t\t\t\tministry_id: '@ministry_id'\n\t\t\t}, {\n\t\t\t\tget:    {\n\t\t\t\t\tmethod: 'GET', interceptor: {\n\t\t\t\t\t\tresponse: function ( response ) {\n\t\t\t\t\t\t\treturn normalizeProfile( response.resource );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tquery:  {\n\t\t\t\t\tmethod: 'GET', isArray: true, interceptor: {\n\t\t\t\t\t\tresponse: function ( response ) {\n\t\t\t\t\t\t\treturn angular.forEach( response.resource, normalizeProfile );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: {method: 'POST'},\n\t\t\t\tupdate: {method: 'PUT'}\n\t\t\t} );\n\t\tapi.defaultProfile = function () {\n\t\t\treturn normalizeProfile( {\n\t\t\t\tis_secure: false\n\t\t\t} );\n\t\t};\n\t\treturn api;\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.factory( 'Session', function ( $injector, $q, $log, Settings ) {\n\t\tvar token,\n\t\t\tsession;\n\n\t\treturn {\n\t\t\tgetSession:    function () {\n\t\t\t\tvar deferred = $q.defer();\n\t\t\t\tif ( angular.isDefined( session ) ) {\n\t\t\t\t\tdeferred.resolve( session );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$injector.get( '$http' )\n\t\t\t\t\t\t.get( Settings.api.measurements( '/token' ), {params: {st: Settings.ticket}} )\n\t\t\t\t\t\t.then( function ( response ) {\n\t\t\t\t\t\t\ttoken = response.data.session_ticket;\n\t\t\t\t\t\t\tsession = response.data;\n\t\t\t\t\t\t\tdeferred.resolve( session );\n\t\t\t\t\t\t}, function ( reason ) {\n\t\t\t\t\t\t\tdeferred.reject( reason );\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\treturn deferred.promise;\n\t\t\t},\n\t\t\trequest:       function ( config ) {\n\t\t\t\tif ( config.url.indexOf( Settings.api.measurements() ) === 0 ) {\n\t\t\t\t\t$log.debug( 'Measurements API Request', config );\n\n\t\t\t\t\t// Enable HTTP Credentials for measurements API requests\n\t\t\t\t\tconfig.withCredentials = true;\n\n\t\t\t\t\t// Add token to request as Authorization Bearer\n\t\t\t\t\tif ( !angular.isUndefined( token ) ) {\n\t\t\t\t\t\tconfig.headers['Authorization'] = 'Bearer ' + token;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn config;\n\t\t\t},\n\t\t\tresponseError: function ( response ) {\n\t\t\t\treturn $q.reject( response );\n\t\t\t}\n\t\t}\n\t} );\n})( angular.module( 'globalProfile.api.measurements' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.directive( 'profileForm', ['$log', 'Languages', 'Countries', 'Ministries', function ( $log, Languages, Countries, Ministries ) {\n\t\t\tvar defaultRequiredFields = [\n\t\t\t\t'cas_username',\n\t\t\t\t'last_name',\n\t\t\t\t'first_name',\n\t\t\t\t'gender',\n\t\t\t\t'birth_date',\n\t\t\t\t'marital_status',\n\t\t\t\t'country_of_residence',\n\t\t\t\t'language1',\n\t\t\t\t'organizational_status',\n\t\t\t\t'funding_source',\n\t\t\t\t'date_joined_staff',\n\t\t\t\t'ministry_of_employment',\n\t\t\t\t'assignment_ministry',\n\t\t\t\t'mcc',\n\t\t\t\t'position_role',\n\t\t\t\t'scope'\n\t\t\t];\n\t\t\treturn {\n\t\t\t\trestrict:    'E',\n\t\t\t\trequire:     ['^ngModel'],\n\t\t\t\tscope:       {\n\t\t\t\t\tprofile:        '=ngModel',\n\t\t\t\t\trequiredFields: '=?profileRequiredFields'\n\t\t\t\t},\n\t\t\t\ttemplateUrl: 'js/components/profile-form/profile-form.html',\n\t\t\t\ttransclude:  true,\n\t\t\t\tlink:        function ( $scope, $element, $attrs ) {\n\t\t\t\t\tLanguages.languages().then( function ( languages ) {\n\t\t\t\t\t\t$scope.languages = languages;\n\t\t\t\t\t} );\n\n\t\t\t\t\tCountries.countries().then( function ( countries ) {\n\t\t\t\t\t\t$scope.countries = countries;\n\t\t\t\t\t} );\n\n\t\t\t\t\tMinistries.query( {whq_only: 'true'}, function ( ministries ) {\n\t\t\t\t\t\t$scope.ministries = ministries;\n\t\t\t\t\t} );\n\n\t\t\t\t\t$scope.showHelp = angular.isUndefined( $attrs.profileShowHelp ) ? true : $scope.$eval( $attrs.profileShowHelp ) === true;\n\t\t\t\t\t$scope.showPrivacy = $scope.$eval( $attrs.profileShowPrivacy ) === true;\n\t\t\t\t\t$scope.showLeftStaff = $scope.$eval( $attrs.profileShowLeftStaff ) === true;\n\n\t\t\t\t\tif ( angular.isUndefined( $attrs.profileRequiredFields ) ) {\n\t\t\t\t\t\t$scope.requiredFields = defaultRequiredFields;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.isRequired = function ( name ) {\n\t\t\t\t\t\treturn $scope.requiredFields.indexOf( name ) > -1;\n\t\t\t\t\t};\n\n\t\t\t\t\t$scope.$watch( 'profile.organizational_status', function ( organizational_status, oldVal ) {\n\t\t\t\t\t\tif ( angular.isUndefined( organizational_status ) || organizational_status == 'Volunteer' || organizational_status == 'Other' ) {\n\t\t\t\t\t\t\t$scope.showStaffDates = false;\n\t\t\t\t\t\t\t$scope.requiredFields = _.without( $scope.requiredFields, 'date_joined_staff' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$scope.showStaffDates = true;\n\t\t\t\t\t\t\tif ( _.indexOf( $scope.requiredFields, 'date_joined_staff' ) === -1 ) {\n\t\t\t\t\t\t\t\t$scope.requiredFields.push( 'date_joined_staff' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\t$scope.$watch( 'profile.funding_source', function ( funding_source, oldVal ) {\n\t\t\t\t\t\tif ( angular.isUndefined( funding_source ) || funding_source == 'Other' ) {\n\t\t\t\t\t\t\t$scope.showEmploymentMinistry = false;\n\t\t\t\t\t\t\t$scope.requiredFields = _.without( $scope.requiredFields, 'ministry_of_employment' );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t$scope.showEmploymentMinistry = true;\n\t\t\t\t\t\t\tif ( _.indexOf( $scope.requiredFields, 'ministry_of_employment' ) === -1 ) {\n\t\t\t\t\t\t\t\t$scope.requiredFields.push( 'ministry_of_employment' );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}] );\n\n})( angular.module( 'globalProfile.components.profileFormDirective', [\n\t'globalProfile.api.measurements'\n] ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.controller( 'SidebarController', function ( $log, $scope, $state, people ) {\n\t\t\t$scope.$state = $state;\n\t\t\t$scope.people = people;\n\t\t\t$scope.filterText = '';\n\n\t\t\t$scope.clearFilter = function () {\n\t\t\t\t$scope.filterText = '';\n\t\t\t}\n\t\t} );\n\n})( angular.module( 'globalProfile.states.admin' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.controller( 'SelectMinistryController', function ( $log, $scope, $state, session, systems ) {\n\t\tfunction flatten( a, prop ) {\n\t\t\tvar items = [];\n\t\t\tangular.forEach( a, function ( item ) {\n\t\t\t\titems.push( item );\n\t\t\t\tif ( item.hasOwnProperty( prop ) && angular.isArray( item[prop] ) ) {\n\t\t\t\t\titems = items.concat( flatten( item[prop], prop ) );\n\t\t\t\t}\n\t\t\t} );\n\t\t\treturn items;\n\t\t}\n\n\t\tvar assignments = flatten( session.assignments, 'sub_ministries' );\n\n\t\t$scope.$state = $state;\n\t\t$scope.ministries = systems;\n\n\t\t$scope.isLeader = function ( ministry_id ) {\n\t\t\tvar roles = _.pluck( _.where( assignments, {ministry_id: ministry_id} ), 'team_role' );\n\t\t\treturn _.contains( roles, 'leader' ) || _.contains( roles, 'inherited_leader' );\n\t\t};\n\t} );\n\n})( angular.module( 'globalProfile.states.selectMinistry' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.controller( 'AddProfileController', function ( $log, $scope, $state, profile, ministry, Profile ) {\n\t\t\t$scope.$state = $state;\n\t\t\t$scope.requiredFields = [\n\t\t\t\t'cas_username',\n\t\t\t\t'last_name',\n\t\t\t\t'first_name',\n\t\t\t\t'gender',\n\t\t\t\t'birth_date',\n\t\t\t\t'marital_status',\n\t\t\t\t'country_of_residence',\n\t\t\t\t'language1',\n\t\t\t\t'organizational_status',\n\t\t\t\t'funding_source',\n\t\t\t\t'date_joined_staff',\n\t\t\t\t'ministry_of_employment',\n\t\t\t\t'assignment_ministry',\n\t\t\t\t'mcc',\n\t\t\t\t'position_role',\n\t\t\t\t'scope'\n\t\t\t];\n\t\t\t$scope.profile = angular.copy( profile );\n\n\t\t\t$scope.resetForm = function () {\n\t\t\t\t$scope.profile = angular.copy( profile );\n\t\t\t};\n\n\t\t\t$scope.saveProfile = function () {\n\t\t\t\tProfile.create( {ministry_id: ministry.ministry_id}, $scope.profile, function ( result ) {\n\t\t\t\t\t$state.go( 'admin.edit', {person_ID: result.person_id}, {reload: true} );\n\t\t\t\t}, function () {\n\t\t\t\t\t$log.error( 'Error Saving Profile' );\n\t\t\t\t} );\n\t\t\t};\n\n\t\t\t$scope.$on( '$stateChangeStart', function ( event, toState, toParams, fromState, fromParams ) {\n\t\t\t\tif ( $scope.profileForm.$dirty ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t$modal.open( {\n\t\t\t\t\t\ttemplateUrl: 'js/states/admin/unsaved.modal.html',\n\t\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\n\t\t\t\t\t\t\t$scope.save = function () {\n\t\t\t\t\t\t\t\t$modalInstance.close();\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t$scope.cancel = function () {\n\t\t\t\t\t\t\t\t$modalInstance.dismiss( 'discard' );\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} ).result.then( function () {\n\t\t\t\t\t\t}, function ( action ) {\n\t\t\t\t\t\t\tif ( action === 'discard' ) {\n\t\t\t\t\t\t\t\t$scope.profileForm.$setPristine();\n\t\t\t\t\t\t\t\t$state.transitionTo( toState, toParams );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t} );\n\n})( angular.module( 'globalProfile.states.admin.add' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.controller( 'EditProfileController', function ( $log, $scope, $state, profile, ministry, Profile, $modal ) {\n\t\t\t$scope.$state = $state;\n\t\t\t$scope.requiredFields = [\n\t\t\t\t'cas_username',\n\t\t\t\t'last_name',\n\t\t\t\t'first_name',\n\t\t\t\t'gender',\n\t\t\t\t'birth_date',\n\t\t\t\t'marital_status',\n\t\t\t\t'country_of_residence',\n\t\t\t\t'language1',\n\t\t\t\t'organizational_status',\n\t\t\t\t'funding_source',\n\t\t\t\t'date_joined_staff',\n\t\t\t\t'ministry_of_employment',\n\t\t\t\t'assignment_ministry',\n\t\t\t\t'mcc',\n\t\t\t\t'position_role',\n\t\t\t\t'scope'\n\t\t\t];\n\t\t\t$scope.profile = angular.copy( profile );\n\n\t\t\t$scope.resetForm = function () {\n\t\t\t\t$scope.profile = angular.copy( profile );\n\t\t\t\t$scope.profileForm.$setPristine();\n\t\t\t};\n\n\t\t\t$scope.saveChanges = function () {\n\t\t\t\tProfile.update( {ministry_id: ministry.ministry_id}, $scope.profile, function ( result ) {\n\t\t\t\t\tprofile = result;\n\t\t\t\t\t$scope.profile = angular.copy( profile );\n\t\t\t\t\t$scope.profileForm.$setPristine();\n\t\t\t\t}, function () {\n\t\t\t\t\t$log.error( 'Error Saving Profile' );\n\t\t\t\t} );\n\t\t\t};\n\n\t\t\t$scope.$on( '$stateChangeStart', function ( event, toState, toParams, fromState, fromParams ) {\n\t\t\t\tif ( $scope.profileForm.$dirty ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t$modal.open( {\n\t\t\t\t\t\ttemplateUrl: 'js/states/admin/unsaved.modal.html',\n\t\t\t\t\t\tcontroller:  function ( $scope, $modalInstance ) {\n\t\t\t\t\t\t\t$scope.save = function () {\n\t\t\t\t\t\t\t\t$modalInstance.close();\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t$scope.cancel = function () {\n\t\t\t\t\t\t\t\t$modalInstance.dismiss( 'discard' );\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t} ).result.then( function () {\n\t\t\t\t\t\t}, function ( action ) {\n\t\t\t\t\t\t\tif ( action === 'discard' ) {\n\t\t\t\t\t\t\t\t$scope.profileForm.$setPristine();\n\t\t\t\t\t\t\t\t$state.transitionTo( toState, toParams );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\n})( angular.module( 'globalProfile.states.admin.edit' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule\n\t\t.controller( 'ImportCSVController', function ( $log, $scope, $state, ministry, Profile ) {\n\t\t\t$scope.$state = $state;\n\t\t\t$scope.hasHeader = true;\n\t\t\t$scope.columns = [];\n\t\t\t$scope.pager = {\n\t\t\t\tpage:  1,\n\t\t\t\tbegin: 0\n\t\t\t};\n\n\t\t\t$scope.browse = function () {\n\t\t\t\tdocument.getElementById( 'fileBrowser' ).click();\n\t\t\t};\n\n\t\t\t$scope.$watch( 'file', function ( file ) {\n\t\t\t\tif ( angular.isUndefined( file ) ) return;\n\t\t\t\tparseCSV();\n\t\t\t} );\n\n\t\t\t$scope.$watch( 'hasHeader', function ( hasHeader ) {\n\t\t\t\tparseCSV();\n\t\t\t} );\n\n\t\t\t$scope.$watch( 'pager.page', function ( page ) {\n\t\t\t\tif ( angular.isUndefined( $scope.csv ) ) return;\n\t\t\t\t$scope.pager.begin = (page - 1) * 10;\n\t\t\t} );\n\n\t\t\tfunction parseCSV() {\n\t\t\t\tif ( angular.isUndefined( $scope.file ) ) return;\n\t\t\t\tif ( angular.isUndefined( $scope.hasHeader ) ) return;\n\n\t\t\t\tPapa.parse( $scope.file, {\n\t\t\t\t\theader:   false, // We remove first row manually if hasHeader is true\n\t\t\t\t\tcomplete: function ( results, file ) {\n\t\t\t\t\t\tvar columns = [];\n\t\t\t\t\t\t$scope.$apply( function () {\n\t\t\t\t\t\t\tif ( $scope.hasHeader ) {\n\t\t\t\t\t\t\t\t$scope.headerRow = results.data.shift();\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < $scope.headerRow.length; i++ )\n\t\t\t\t\t\t\t\t\tcolumns.push( {index: i} );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdelete $scope.headerRow;\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < results.data[0].length; i++ )\n\t\t\t\t\t\t\t\t\tcolumns.push( {index: i} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$scope.columns = columns;\n\t\t\t\t\t\t\t$scope.csv = results;\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t}\n\t\t} );\n\n})( angular.module( 'globalProfile.states.admin.import' ) );\n","(function ( module ) {\n\t'use strict';\n\n\tmodule.controller( 'EditPersonalProfileController', function ( $log, $scope, session, ministry, profile, Profile ) {\n\t\t$scope.profile = angular.copy( profile );\n\n\t\t$scope.resetForm = function () {\n\t\t\t$scope.profile = angular.copy( profile );\n\t\t\t$scope.profileForm.$setPristine();\n\t\t};\n\n\t\t$scope.saveChanges = function () {\n\t\t\tvar method = angular.isUndefined( profile.id ) ? 'create' : 'update';\n\t\t\tProfile[method]( {ministry_id: ministry.ministry_id}, $scope.profile, function ( response ) {\n\t\t\t\tprofile = response;\n\t\t\t\t$scope.profile = angular.copy( profile );\n\t\t\t\t$scope.profileForm.$setPristine();\n\t\t\t} );\n\t\t};\n\t} );\n})( angular.module( 'globalProfile.states.profile.edit' ) );\n"],"sourceRoot":"/source/"}